# Тестовое задание #2

## Содержание

- [Исходное описание](#original)
- [Интерпретация задачи](#description)
- [Порядок разворачивания проекта](#deploy)
- [О написанном коде](#about-code)

## <a name="original"></a> Исходное описание

Написать приложение на laravel, реализующее базовый API для работы с клиентами. У клиента есть имя, фамилия, один или более номеров телефона, один или более почтовых ящиков. Нужно сделать пять методов: добавления, просмотра, изменения, удаления, поиска клиента. Поиск осуществляется в четырех вариантах: по имени и фамилии, телефону, почте или по всем предыдущим опциям одновременно. Тип поиска передается в параметре запроса. Доступ к API осуществляется по токену. Необходимо вести лог всех операций через API с сохранением авторства.

## <a name="description"></a> Интерпретация задачи

1. При реализации API отталкивался от спецификации https://jsonapi.org/
1. Клиенты, Электронные адреса и Телефоны - три ресурса. Сначала создаётся ресурс Клиент, затем через него создаются ресурсы Почта и Телефон в нужном количестве.
1. Сделано допущение, что для изменения ресурса, нужно отправить все его атрибуты, даже те, которые не изменились. Универсальная реализация оставлена на потом.
1. Так как Почта и Телефон отдельные ресурсы, сделано допущение, что их нельзя изменить через изменение ресурса Клиент. Универсальная реализация оставлена на потом.
1. Примеры запросов см. в файле `/requests.http` (можно использовать в PhpStorm HTTP Client)
1. Для всех трёх ресурсов доступны методы `GET`, `POST`, `PATCH`, `DELETE`. `GET` - как для получения всей коллекции ресурсов, так и для получения конкретного ресурса.
1. Для логгирования действий используется таблица `api_actions_log`
1. При получении списка клиентов можно пользоваться фильтрами `name`, `email`, `phone`
1. Документирование API через Swagger оставлено на потом.

 ## <a name="deploy"></a> Порядок разворачивания проекта
 
* Склонировать проект
* Установить зависимости через Composer
* В `.env` файле в блоке с БД указать данные соединения, пример:
 ```
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=laravel
DB_USERNAME=mysql
DB_PASSWORD=mysql
 ```
* В консоли из корня проекта выполнить команды:
 ```
 php artisan config:cache
 php artisan migrate --seed
 ```
* Запустить сервер `php artisan serve`

## <a name="about-code"></a> О написанном коде

* Миграции в `/database/migrations/*`
* Маршруты в `/routes/api.php`
* Seeder's в `/database/seeds/*`
* Модели в `/app/Models/*`
* Контроллеры в `/app/Http/Controllers/*`
* Form Requests в `/app/Http/Requests/*`
* Ресурсы в `/app/Http/Resources/*`
* Посредник участвующий в логгировании действий `/app/Http/Middleware/ActionLogger.php`